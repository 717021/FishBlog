var main=new Vue({el:"#main",data:{message:"Hello Vue.js !",contentMainLoading:!1,contentMainLoadFailed:!1,contentMainLoadError:"",contentPosts:null,currentPostPage:0,allPostPage:0,contentLoadDateA:"0",contentLoadDateM:"0",contentLoadDateY:"0",currentDateShow:""},methods:{loadStart:function(){var cm=getQueryString("month");isNullOrEmpty(cm)&&(cm=getLastUrlAgrs(location.href)),isNumber(cm.arg)&&(this.contentLoadDateM=cm.arg);var cy=getQueryString("year");isNullOrEmpty(cy)&&(cy=getLastUrlAgrs(cm.removedStr+"/")),isNumber(cy.arg)&&(this.contentLoadDateY=cy.arg),"0"!=this.contentLoadDateM&&4==this.contentLoadDateY.length?(this.contentLoadDateA=this.contentLoadDateY+"-"+this.contentLoadDateM,this.loadDatePosts()):this.currentDateShow="神秘时间",$("title").text("文章归档 "+this.currentDateShow+" - ALONE SPACE")},loadDatePosts:function(){var url=address_blog_api+"posts/page/"+this.currentPostPage+"/10?sortBy=date&noTopMost=true&byDate="+this.contentLoadDateY+"-"+this.contentLoadDateM,oldScrollTop=$("body,html").scrollTop();this.currentDateShow=this.contentLoadDateY+" 年 "+this.contentLoadDateM+" 月 发表的文章",this.contentMainLoading=!0,$.ajax({url:url,success:function(response){main.contentMainLoading=!1,response.success?(main.allPostPage=response.data.totalPages,null==main.contentPosts?main.contentPosts=response.data.content:main.contentPosts=mergeJsonArray(main.contentPosts,response.data.content),main.reloadPostStats(),main.currentPostPage++,$("body,html").scrollTop(oldScrollTop)):(main.contentMainLoadError=response.message,main.contentMainLoadFailed=!0)},error:function(xhr,err){main.contentMainLoadError=err,main.contentMainLoadFailed=!0}})},getDateString:function(str){return arr=str.split("-"),arr[0]+" 年 "+arr[1]+" 月"},getImageUrl:function(str){return getImageUrlFormHash(str)},getPostUrl:function(post){return getPostRealUrl(post)},getPostPrefix:function(prefixId){return getPostPrefix(prefixId)},reloadPostStats:function(){var getPosts={archives:[]};for(var key in main.contentPosts)main.contentPosts[key].id&&getPosts.archives.push(main.contentPosts[key].id);var findOldPosts=function(id){for(var key in main.contentPosts)if(main.contentPosts[key].id==id)return main.contentPosts[key];return null},reloadPostsStat=function(arr){for(var key in arr){var o=findOldPosts(key);o&&(o.viewCount=arr[key].viewCount,o.commentCount=arr[key].commentCount)}};$.ajax({url:address_blog_api+"posts/stat",type:"post",data:JSON.stringify(getPosts),contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){response.success&&reloadPostsStat(response.data)},error:function(xhr,err){}})}}});setLoaderFinishCallback(function(){main.loadStart(),setTimeout(function(){main.$refs.sideArea.loadAll()},500)});