var main;function initApp(){main=new Vue({el:"#main",data:{currentIsSending:!1,currentAddStartValid:!1,currentAddPasswdStartValid:!1,currentAddPasswd2StartValid:!1,currentAddUserName:"",currentAddUserFriendlyName:"",currentAddUserEmail:"",currentAddUserEmailStartValid:!1,currentAddUserPassword:"",currentAddUserPassword2:"",currentAddSuccess:!1},methods:{canRegister:()=>enableRegister,init(){$("#signup_new").focus(function(){main.currentAddPasswdStartValid=!0,$("#password_type").slideDown()}),$("#signup_new").blur(function(){main.preSubmitValid()||$("#password_type").slideUp()}),$("#signup_new2").focus(function(){main.currentAddPasswd2StartValid=!0}),$("#signup_email").focus(function(){main.currentAddUserEmailStartValid=!0})},validEmail0(){return this.currentAddStartValid&&isNullOrEmpty(this.currentAddUserEmail)?" is-invalid":this.validEmail1()?" is-invalid":""},validEmail1(){if(!this.currentAddStartValid&&!this.currentAddUserEmailStartValid)return!1;var email=this.currentAddUserEmail,reg;return""!=email&&!/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(email)},validPassWord1(){return this.currentAddPasswdStartValid&&(this.validPassWord1Len()||this.validPassWord1Char()||this.validPassWord1UserName())?" is-invalid":""},validPassWord1Len(){return isNullOrEmpty(this.currentAddUserPassword)||this.currentAddUserPassword.length<8},validPassWord1Char(){return!new RegExp(/(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?]+)$)^[\w~!@#$%\^&*?]+$/).test(this.currentAddUserPassword)},validPassWord1UserName:()=>!1,validPassWord2(){return!this.currentAddStartValid&&!this.currentAddPasswd2StartValid||!isNullOrEmpty(this.currentAddUserPassword2)&&this.currentAddUserPassword==this.currentAddUserPassword2?"":" is-invalid"},preSubmitValid(){return" is-invalid"==this.validEmail0()||" is-invalid"==this.validPassWord2()||!!(this.validPassWord1Len()||this.validPassWord1Char()||this.validPassWord1UserName())},submitChange(){if(!this.currentIsSending)if(this.currentIsSending=!0,this.currentAddStartValid=!0,this.preSubmitValid())$("#password_type").slideDown();else if(main.currentAddUserEmail!=main.currentAddUserPassword){var t=toast("正在提交中...","loading",-1);$.ajax({url:address_blog_api+"users/sign-up",type:"post",dataType:"json",data:JSON.stringify({email:main.currentAddUserEmail,passwd:md5(main.currentAddUserPassword)}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){toastClose(t),main.currentIsSending=!1,response.success?main.currentAddSuccess=!0:swal("提交失败",response.message,"error")},error:function(xhr,err){toastClose(t),toast("提交失败 : "+err,"error",5e3),main.currentIsSending=!1}})}else swal("密码不可与邮箱相同！","","error")}}})}setLoaderFinishCallback(function(){initApp(),setTimeout(function(){main.init()},800)});