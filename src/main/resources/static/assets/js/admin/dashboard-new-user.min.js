var main;function initAuthInfoEnd(user){main.userInfoLoaded=!0,user&&(getUserHasPrivilege(user,userPrivileges.manageUsers)||user.level==userLevels.admin)&&(user.level!=userLevels.admin&&0==(user.privilege&userPrivileges.manageAllArchives)||(main.userHasManagePrivilege=!0),main.currentUser=user,main.hasPrivilege=!0)}function initApp(){main=new Vue({el:"#main",data:{contentLoadStatus:contentLoadStatus,content:null,hasPrivilege:!1,userInfoLoaded:!1,userHasManagePrivilege:!1,currentUser:null,currentAddStartValid:!1,currentAddUserName:"",currentAddUserFriendlyName:"",currentAddUserPassword:"",currentAddUserPassword2:"",currentAddSuccess:!1},methods:{isCurrentUrlAndActive:function(page){return isCurrentUrlAndActive(page)},clearInput(){this.currentAddSuccess=!1,this.currentAddStartValid=!1,this.currentAddUserName="",this.currentAddUserFriendlyName="",this.currentAddUserPassword="",this.currentAddUserPassword2=""},validPassWord1(){return this.currentAddStartValid&&(isNullOrEmpty(this.currentAddUserPassword)||this.currentAddUserPassword.length<8)?" is-invalid":""},validPassWord2(){return this.currentAddStartValid&&(isNullOrEmpty(this.currentAddUserPassword2)||this.currentAddUserPassword!=this.currentAddUserPassword2)?" is-invalid":""},preSubmitValid(){return this.currentAddStartValid=!0,!!(isNullOrEmpty(this.currentAddUserName)||isNullOrEmpty(this.currentAddUserFriendlyName)||isNullOrEmpty(this.currentAddUserPassword)||isNullOrEmpty(this.currentAddUserPassword2))||(" is-invalid"==this.validPassWord1()||" is-invalid"==this.validPassWord2())},submit(){if(!this.preSubmitValid()){var t=toast("正在提交中...","loading",-1);$.ajax({url:address_blog_api+"users",type:"post",dataType:"json",data:JSON.stringify({name:main.currentAddUserName,friendlyName:main.currentAddUserFriendlyName,passwd:md5(main.currentAddUserPassword)}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){toastClose(t),response.success?main.currentAddSuccess=!0:swal("添加用户失败",response.message,"error")},error:function(xhr,err){toastClose(t),toast("添加用户失败 : "+err,"error",5e3)}})}}}})}appendLoaderJS("/assets/libs/compress/md5.min.js");